<!-- components/header.html -->
<header class="site-header">
    <div class="header-wrapper">
        <!-- Logo -->
        <div class="logo">
            <a href="https://moonstore.codearlo.com">
                <img src="../assets/img/logo.png?v=20250517" alt="Moon Store Logo">
                <span>Moon Store</span>
            </a>
        </div>
        
        <!-- Barra de búsqueda (desktop y mobile) -->
        <div class="search-container">
            <input type="text" id="searchInput" placeholder="Buscar productos..." class="search-input">
            <button type="button" class="search-button" id="searchButton">
                <svg viewBox="0 0 24 24" width="20" height="20">
                    <path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" fill="currentColor"/>
                </svg>
                Buscar
            </button>
        </div>
        
        <!-- Botones de usuario y carrito -->
        <div class="header-actions">
            <!-- Icono de perfil que abre sidebar -->
            <button class="action-button profile-button" id="profileButton">
                <svg viewBox="0 0 24 24" width="24" height="24">
                    <path d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z" fill="currentColor"/>
                </svg>
            </button>
            
            <!-- Carrito -->
            <button class="action-button cart-button" id="cartButton">
                <svg viewBox="0 0 24 24" width="24" height="24">
                    <path d="M7.2998 5H22L20 12H8.37675M21 16H9L7 3H4M4 8H2M5 11H2M6 14H2M10 20C10 20.5523 9.55228 21 9 21C8.44772 21 8 20.5523 8 20C8 19.4477 8.44772 19 9 19C9.55228 19 10 19.4477 10 20ZM21 20C21 20.5523 20.5523 21 20 21C19.4477 21 19 20.5523 19 20C19 19.4477 19.4477 19 20 19C20.5523 19 21 19.4477 21 20Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                </svg>
                <span class="cart-count">0</span>
            </button>
        </div>
    </div>
    
    <!-- Navegación de productos -->
    <nav class="products-nav">
        <div class="nav-container">
            <ul class="nav-menu" id="navMenu">
                <li class="nav-item dropdown">
                    <button class="nav-link dropdown-toggle" data-category="todos">
                        TODOS LOS PRODUCTOS
                        <svg class="dropdown-icon" viewBox="0 0 24 24" width="16" height="16">
                            <path d="M7,10L12,15L17,10H7Z" fill="currentColor"/>
                        </svg>
                    </button>
                    <div class="dropdown-menu">
                        <a href="productos.html" class="dropdown-item">Ver todos</a>
                        <a href="productos.html?categoria=gaming" class="dropdown-item">PC Gaming</a>
                        <a href="productos.html?categoria=workstation" class="dropdown-item">Workstations</a>
                        <a href="productos.html?categoria=accesorios" class="dropdown-item">Accesorios</a>
                        <a href="productos.html?categoria=componentes" class="dropdown-item">Componentes</a>
                    </div>
                </li>
                
                <li class="nav-item">
                    <a href="index.html#ofertas" class="nav-link">
                        OFERTAS
                        <span class="offer-badge">DE LOCURA</span>
                    </a>
                </li>
                
                <li class="nav-item">
                    <a href="productos.html?categoria=pc-completas" class="nav-link">PC COMPLETAS</a>
                </li>
                
                <li class="nav-item">
                    <a href="productos.html?categoria=monitor" class="nav-link">MONITOR</a>
                </li>
                
                <li class="nav-item">
                    <a href="index.html#servicios" class="nav-link">SERVICIOS</a>
                </li>
                
                <li class="nav-item">
                    <a href="index.html#contacto" class="nav-link">CONTACTO</a>
                </li>
            </ul>
        </div>
    </nav>
</header>

<!-- Sidebar de perfil -->
<div id="profileSidebar" class="profile-sidebar">
    <div class="sidebar-content">
        <div class="sidebar-header">
            <h3>Mi Cuenta</h3>
            <button class="sidebar-close" id="closeSidebar">
                <svg viewBox="0 0 24 24" width="24" height="24">
                    <path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" fill="currentColor"/>
                </svg>
            </button>
        </div>
        
        <!-- Contenido para usuario no logueado -->
        <div id="guestContent" class="sidebar-section">
            <div class="auth-section">
                <h4>¡Únete a nosotros!</h4>
                <p>Accede a ofertas exclusivas y gestiona tus pedidos</p>
                
                <div class="auth-buttons-sidebar">
                    <a href="login.html" class="sidebar-button login-btn">
                        <svg viewBox="0 0 24 24" width="20" height="20">
                            <path d="M10,17V14H3V10H10V7L15,12L10,17M10,2H19A2,2 0 0,1 21,4V20A2,2 0 0,1 19,22H10A2,2 0 0,1 8,20V18H10V20H19V4H10V6H8V4A2,2 0 0,1 10,2Z" fill="currentColor"/>
                        </svg>
                        Iniciar Sesión
                    </a>
                    
                    <a href="register.html" class="sidebar-button register-btn">
                        <svg viewBox="0 0 24 24" width="20" height="20">
                            <path d="M15,14C12.33,14 7,15.33 7,18V20H23V18C23,15.33 17.67,14 15,14M6,10V7H4V10H1V12H4V15H6V12H9V10M15,12A4,4 0 0,0 19,8A4,4 0 0,0 15,4A4,4 0 0,0 11,8A4,4 0 0,0 15,12Z" fill="currentColor"/>
                        </svg>
                        Registrarse
                    </a>
                </div>
            </div>
        </div>
        
        <!-- Contenido para usuario logueado (oculto por defecto) -->
        <div id="userContent" class="sidebar-section" style="display: none;">
            <div class="user-info">
                <div class="user-avatar">
                    <svg viewBox="0 0 24 24" width="40" height="40">
                        <path d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z" fill="currentColor"/>
                    </svg>
                </div>
                <div class="user-details">
                    <h4 id="userName">Usuario</h4>
                    <p id="userEmail">usuario@ejemplo.com</p>
                </div>
            </div>
            
            <div class="user-menu-items">
                <a href="perfil.html" class="sidebar-menu-item">
                    <svg viewBox="0 0 24 24" width="20" height="20">
                        <path d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z" fill="currentColor"/>
                    </svg>
                    Mi Perfil
                </a>
                
                <a href="pedidos.html" class="sidebar-menu-item">
                    <svg viewBox="0 0 24 24" width="20" height="20">
                        <path d="M19,7H16V6A4,4 0 0,0 8,6V7H5A1,1 0 0,0 4,8V19A3,3 0 0,0 7,22H17A3,3 0 0,0 20,19V8A1,1 0 0,0 19,7M10,6A2,2 0 0,1 14,6V7H10V6M18,19A1,1 0 0,1 17,20H7A1,1 0 0,1 6,19V9H8V11H10V9H14V11H16V9H18V19Z" fill="currentColor"/>
                    </svg>
                    Mis Pedidos
                </a>
                
                <a href="favoritos.html" class="sidebar-menu-item">
                    <svg viewBox="0 0 24 24" width="20" height="20">
                        <path d="M12,21.35L10.55,20.03C5.4,15.36 2,12.27 2,8.5C2,5.41 4.42,3 7.5,3C9.24,3 10.91,3.81 12,5.08C13.09,3.81 14.76,3 16.5,3C19.58,3 22,5.41 22,8.5C22,12.27 18.6,15.36 13.45,20.03L12,21.35Z" fill="currentColor"/>
                    </svg>
                    Favoritos
                </a>
                
                <button class="sidebar-menu-item logout-item" onclick="logout()">
                    <svg viewBox="0 0 24 24" width="20" height="20">
                        <path d="M16,17V14H9V10H16V7L21,12L16,17M14,2A2,2 0 0,1 16,4V6H14V4H5V20H14V18H16V20A2,2 0 0,1 14,22H5A2,2 0 0,1 3,20V4A2,2 0 0,1 5,2H14Z" fill="currentColor"/>
                    </svg>
                    Cerrar Sesión
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Overlay para el sidebar -->
<div id="sidebarOverlay" class="sidebar-overlay"></div>

<!-- Overlay para el menú móvil -->
<div id="menuOverlay" class="menu-overlay"></div>

<!-- Script para forzar recarga de recursos -->
<script>
    // Forzar recarga de recursos críticos
    const timestamp = Date.now();
    document.querySelectorAll('.logo img, .cart-icon').forEach(img => {
        if (img.src) {
            const currentSrc = img.getAttribute('src');
            if (currentSrc.includes('?')) {
                img.setAttribute('src', currentSrc.split('?')[0] + '?v=' + timestamp);
            } else {
                img.setAttribute('src', currentSrc + '?v=' + timestamp);
            }
        }
    });
</script>